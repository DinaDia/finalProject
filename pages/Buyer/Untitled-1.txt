import styles from '@/styles/buyer.module.css'
import Head from 'next/head'
import { useState } from 'react'
import Image from 'next/image'

export const getStaticProps=async()=>{

    const res=await fetch('http://localhost:8000/products');
    const data= await res.json();

    const resOne=await fetch('http://localhost:8000/availableProducts');
    const dataOne=await resOne.json();
    return{
        props: {
            products: data,
            availableProducts: dataOne
        },
    };
  }



const Products = ({products, availableProducts}) => {

    const [product, setProduct]=useState();
    const [quantity, setQuantity]=useState();

    const[ sorting, setSorting]=useState('');

    const handleSubmit=(e)=>{
        e.preventDefault();
        console.log(sorting)
        console.log(product)
    }

  return (
    <div>
        <Head>
            <title>Products | FarmConnectET</title>
        </Head>

        <div className={styles.sideBarStyle}>
        <form className={styles.formStyle}>
            <label className={styles.labelStyle}>Product</label>
            <select className={styles.optionStyle} value={product}
            onChange={(e)=>setProduct(e.target.value)}>
                <option hidden>Select product you would like to purchase</option>
                
                {products.map((product, index)=>{
                    return(
                        <option className={styles.optionStyle} key={index} value={product.value}>{product.textValue}</option>
                    )
                })}

            </select>

            <label className={styles.labelStyle}>Quantity</label>
            <input className={styles.inputStyle} type='number'
            value={quantity}  placeholder="Quantity of product in kgs"
            onchange={(e)=>setQuantity(e.target.value)}/>

            <button className={styles.loginButton}
            onClick={handleSubmit}>Calculate</button>
         
        </form>
        </div>

        <div className={styles.sampleContent}>
            <div className={styles.filerStyles}>
                <select className={styles.multipleOptionStyle}
                value={sorting}
                onChange={(e)=>setSorting(e.target.value)}>
                <option hidden>Sorting type</option>
                <option value="Ascending">Ascending</option>
                <option value="Descending">Descending</option>

             </select>

             <select className={styles.multipleOptionStyle}>
                <option hidden>Select Product</option>

                {products.map((product, index)=>{
                    return(
                        <option className={styles.optionStyle} key={index} value={product.value}>{product.textValue}</option>
                    )
                })}

             </select>   

             
             <select className={styles.multipleOptionStyle}>
                <option hidden>Select Product Type</option>

                {products.map((product, index)=>{
                    return(
                        <option className={styles.optionStyle} key={index} value={product.value}>{product.textValue}</option>
                    )
                })}

             </select>            


            </div>

            <div className={styles.listOfProductStyle}>
                {availableProducts.map((availableProduct)=>{
                     return(
                        <div className={styles.individualProduct}>
                            <Image className={styles.pictureStyle} src={availableProduct.src} width={120} height={120}></Image>
                            <div className={styles.productInfo}>{availableProduct.name}</div>
                            
                        </div>
                    )
                })}

            
            </div>

        </div>
    </div>
  )
}

export default Products